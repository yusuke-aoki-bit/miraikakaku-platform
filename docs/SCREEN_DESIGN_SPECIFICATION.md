# Miraikakaku - 画面設計仕様書 (最終版)

## 1. はじめに

このドキュメントは、AI株価予測プラットフォーム「Miraikakaku」の主要画面に関する詳細設計を定義するものです。UI/UXの一貫性を保ち、効率的な開発を促進することを目的とします。

## 2. 新メニュー構成案 (最終版)

ユーザーの4つの主要な行動「市場を見る」「AIで分析する」「楽しむ・競う」「自分を管理する」をトップレベルのメニューに反映した、最終的な構成案です。

- **ダッシュボード (Dashboard):** `/` - 最重要情報を集約したホーム画面。
- **マーケット (Market):**
  - **ランキング:** `/rankings`
  - **テーマ別分析:** `/themes`
  - **セクター分析:** `/sectors`
  - **ニュース:** `/news`
- **AI分析 (AI Analysis):**
  - **個別銘柄予測:** `/predictions`
  - **出来高予測:** `/volume`
  - **為替予測:** `/currency`
- **コミュニティ (Community):**
  - **予測コロシアム:** `/contests`
  - **ユーザーランキング:** `/users/rankings`
- **マイページ (My Page):**
  - **ポートフォリオ:** `/portfolio`
  - **ウォッチリスト:** `/watchlist`
  - **アカウント設定:** `/management`

---

## 3. 各画面の詳細設計

(ここには、以前の設計書に記載した `3.1 ホーム画面` から `3.9 ポートフォリオ画面` までの内容が含まれます。内容は同一のため、ここでは省略します。)

### 3.10. ユーザー管理フロー

- **思想:** ログインなしで価値を体験できる「ゲストモード」を基本とし、必要性を感じたタイミングで自然に登録を促す。
- **登録画面 (`/auth/register`):** ソーシャルログインを併設した、シンプルでセキュアなフォーム。
- **ログイン画面 (`/auth/login`):** 「ログインせずに続ける」選択肢を明確に提示。
- **アカウント管理画面 (`/management`):** プロフィール、セキュリティ（2FA）、通知、プラン管理などを垂直タブで整理。
- **パスワード再設定フロー:** メールを使った、安全で標準的な2ステップのフロー。

### 3.11. 静的ページ

- **ニュース詳細 (`/news/[id]`):** 記事本文と、AIが抽出した関連銘柄を同時に表示。
- **利用規約・プライバシーポリシー (`/terms`, `/privacy`):** 読みやすさを考慮し、ページ内目次を設けたテキストページ。

---

## 4. 新機能の追加設計 (未使用API活用)

### 4.1. AI判断根拠コンポーネント (`AIDecisionFactors`)

- **目的:** AIの予測の透明性と信頼性を劇的に向上させる。
- **配置場所:** 「AI個別銘柄予測」画面で、各予測結果の隣にある情報アイコンをクリックするとモーダルで表示。
- **主要コンポーネント:**
  1.  **タイトルエリア:** 「AIの判断根拠 ({銘柄名})」と、総合的な評価サマリーを表示。
  2.  **要因リスト:** 予測に影響を与えた上位要因を、影響度の大きさを視覚的に示しながらリスト表示。
  3.  **AIによる解説:** 各要因がなぜそのように評価されたのかを、簡潔な文章で説明。
- **必要なAPI:** `/api/predictions/{prediction_id}/factors`, `/api/ai-factors/all`

### 4.2. テーマ別分析画面 (`/themes`)

- **目的:** 「EV」「再生可能エネルギー」といった、大きなトレンドや物語（テーマ）に沿って投資先を発見できるようにする。
- **レイアウト:** 特集エリア + 全テーマ一覧。
- **主要コンポーネント:**
  1.  **`FeaturedThemes`:** 注目のテーマを画像付きの大きなカードで紹介。
  2.  **`AllThemes`:** 全てのテーマを検索・ソート可能なリストで表示。
  3.  **テーマ詳細ページ (`/themes/[theme_name]`):**
      - **`ThemePerformanceChart`:** テーマに属する銘柄群で構成した「テーマ指数」のパフォーマンスを折れ線グラフで表示。
      - **`ThemeStockTable`:** テーマを構成する全銘柄をテーブル表示。
      - **`ThemeInsightsPanel`:** テーマに特化したニュースや、AIによる将来性の分析レポートを表示。
- **必要なAPI:** `/api/insights/themes`, `/api/insights/themes/{theme_name}`

### 4.3. 予測コロシアム画面 (`/contests`)

- **目的:** ゲーミフィケーションにより、ユーザーのエンゲージメントと継続利用率を高める。
- **レイアウト:** 「開催中」「過去のコンテスト」「リーダーボード」を切り替えるタブ形式。
- **主要コンポーネント:**
  1.  **`Active Contests`タブ:** 参加可能なコンテストをカードで一覧表示。お題、報酬、締切までのカウントダウンタイマーを表示。
  2.  **`Past Contests`タブ:** 終了したコンテストの結果と、自分の成績を振り返れる。
  3.  **`Leaderboard`タブ:** 全コンテストを通じた、ユーザーの総合ランキングを表示。称号や累計ポイントも表示。
- **必要なAPI:** `/api/contests/active`, `/api/contests/{contest_id}/predict`, `/api/contests/past` (要追加), `/api/contests/leaderboard` (要追加)