# Miraikakaku Batch System - å®šæœŸã‚«ãƒãƒ¬ãƒƒã‚¸ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ 

å…¨å¸‚å ´100%ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã®è‡ªå‹•ç›£è¦–ãƒ»æ›´æ–°ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

## ğŸ¯ æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

- **è‡ªå‹•ã‚«ãƒãƒ¬ãƒƒã‚¸ç›£è¦–**: å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®Œå…¨æ€§ã‚’ãƒã‚§ãƒƒã‚¯
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°**: æ–°è¦ä¸Šå ´ãƒ»å»ƒæ­¢éŠ˜æŸ„ã®è‡ªå‹•åæ˜ 
- **ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½**: ã‚«ãƒãƒ¬ãƒƒã‚¸ä½ä¸‹æ™‚ã®å³åº§ãªé€šçŸ¥
- **è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: ãƒ‡ãƒ¼ã‚¿æå¤±é˜²æ­¢ã®ãŸã‚ã®å®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ**: è©³ç´°ãªç›£è¦–ãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ç”Ÿæˆ

## ğŸ“Š ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸çŠ¶æ³

âœ… **100%ã‚«ãƒãƒ¬ãƒƒã‚¸é”æˆæ¸ˆã¿**
- æ—¥æœ¬æ ª: 4,168ç¤¾ (100% - TSEå…¨ç¤¾å¯¾å¿œ)
- ç±³å›½æ ª: 8,700ç¤¾ (100% - å…¨å–å¼•æ‰€å¯¾å¿œ)
- ETF: 3,000éŠ˜æŸ„ (100% - æœ€é©åŒ–æ¸ˆã¿)
- åˆè¨ˆ: 15,868è¨¼åˆ¸

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ã‚·ã‚¹ãƒ†ãƒ ç¢ºèª
```bash
# APIãŒç¨¼åƒã—ã¦ã„ã‚‹ã‹ç¢ºèª
curl http://localhost:8000/health

# ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèª
python3 simple_monitor.py
```

### 2. å®šæœŸç›£è¦–è¨­å®š

#### Linux/macOS (crontabä½¿ç”¨)
```bash
# crontabã‚¨ãƒ‡ã‚£ã‚¿èµ·å‹•
crontab -e

# 6æ™‚é–“ã”ã¨ã®ç›£è¦–ã‚’è¿½åŠ 
0 */6 * * * /usr/bin/python3 /path/to/miraikakaku/simple_monitor.py >> /path/to/miraikakaku/logs/monitor.log 2>&1
```

#### Windows (ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼)
1. ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã‚’é–‹ã
2. åŸºæœ¬ã‚¿ã‚¹ã‚¯ã®ä½œæˆã‚’é¸æŠ
3. ãƒˆãƒªã‚¬ãƒ¼: 6æ™‚é–“ã”ã¨
4. æ“ä½œ: `python3 simple_monitor.py`ã‚’å®Ÿè¡Œ

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
miraikakaku/
â”œâ”€â”€ miraikakakubatch.py              # ãƒ¡ã‚¤ãƒ³ãƒãƒƒãƒã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ japanese_stock_updater.py        # æ—¥æœ¬æ ªæ›´æ–°ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ simple_monitor.py                # è»½é‡ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ â­
â”œâ”€â”€ install_batch_system.py          # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼
â”œâ”€â”€ universal_stock_api.py           # ãƒ¡ã‚¤ãƒ³API
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ batch_config.json            # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ logging_config.json          # ãƒ­ã‚°è¨­å®š
â”œâ”€â”€ backups/                         # è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
â”‚   â”œâ”€â”€ japanese_stocks/
â”‚   â”œâ”€â”€ us_stocks/
â”‚   â””â”€â”€ etf_data/
â”œâ”€â”€ reports/                         # ç›£è¦–ãƒ¬ãƒãƒ¼ãƒˆ
â””â”€â”€ logs/                           # ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°
```

## âš™ï¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### config/batch_config.json
```json
{
  "thresholds": {
    "min_japanese_stocks": 4000,
    "min_us_stocks": 8500,
    "min_etfs": 2900,
    "coverage_alert_threshold": 0.95
  },
  "schedule": {
    "daily_maintenance_time": "04:00",
    "weekly_maintenance_day": "monday",
    "weekly_maintenance_time": "06:00",
    "coverage_check_interval_hours": 6
  }
}
```

## ğŸ“‹ ç›£è¦–ã‚³ãƒãƒ³ãƒ‰

### åŸºæœ¬ç›£è¦–
```bash
# ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯
python3 simple_monitor.py

# è©³ç´°ãªãƒãƒƒãƒå‡¦ç†
python3 miraikakakubatch.py --mode check
```

### ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
```bash
# æ—¥æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
python3 miraikakakubatch.py --mode daily

# é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹  
python3 miraikakakubatch.py --mode weekly

# æ—¥æœ¬æ ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°
python3 japanese_stock_updater.py
```

## ğŸ” ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª

ç›£è¦–ãƒ¬ãƒãƒ¼ãƒˆã¯ `reports/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ï¼š

```bash
# æœ€æ–°ã®ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª
ls -la reports/coverage_monitor_*.json | tail -1

# ãƒ¬ãƒãƒ¼ãƒˆå†…å®¹è¡¨ç¤º
cat reports/coverage_monitor_$(date +%Y%m%d)_*.json | jq '.'
```

## ğŸš¨ ã‚¢ãƒ©ãƒ¼ãƒˆæ¡ä»¶

ä»¥ä¸‹ã®æ¡ä»¶ã§ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºç”Ÿã—ã¾ã™ï¼š

- æ—¥æœ¬æ ªæ•° < 4,000ç¤¾
- ç±³å›½æ ªæ•° < 8,500ç¤¾  
- ETFæ•° < 2,900éŠ˜æŸ„
- APIæ¥ç¶šä¸å¯
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ç ´æ

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. APIæ¥ç¶šã‚¨ãƒ©ãƒ¼
```bash
# APIãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
ps aux | grep universal_stock_api

# APIå†èµ·å‹•
python3 universal_stock_api.py &
```

#### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ä¸æ•´åˆ
```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
cp backups/japanese_stocks/japanese_stocks_backup_latest.py comprehensive_japanese_stocks_enhanced.py
```

#### 3. æ¨©é™ã‚¨ãƒ©ãƒ¼
```bash
# å®Ÿè¡Œæ¨©é™ä»˜ä¸
chmod +x *.py
```

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

### ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç¢ºèª
```bash
# CPUã¨ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
top -p $(pgrep -f universal_stock_api)

# ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡
du -sh backups/ reports/ logs/
```

### ãƒ­ã‚°ç¢ºèª
```bash
# ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°
tail -f logs/miraikakaku_batch.log

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
grep ERROR logs/miraikakaku_batch.log
```

## ğŸ”„ è‡ªå‹•æ›´æ–°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| ã‚¿ã‚¹ã‚¯ | é »åº¦ | å®Ÿè¡Œæ™‚é–“ | èª¬æ˜ |
|--------|------|----------|------|
| ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯ | 6æ™‚é–“ã”ã¨ | 0:00, 6:00, 12:00, 18:00 | åŸºæœ¬ç›£è¦– |
| ç±³å›½æ ªåŒæœŸ | æ—¥æ¬¡ | 4:00 | Alpha Vantage APIåŒæœŸ |
| æ—¥æœ¬æ ªæ›´æ–° | é€±æ¬¡ | æœˆæ›œ 6:00 | TSEå…¬å¼ãƒ‡ãƒ¼ã‚¿æ›´æ–° |
| ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ | æ—¥æ¬¡ | 2:00 | å…¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| å¤ã„ãƒ­ã‚°å‰Šé™¤ | é€±æ¬¡ | æ—¥æ›œ 3:00 | 30æ—¥ä»¥ä¸Šå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ |

## ğŸ¯ é‹ç”¨ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. å®šæœŸãƒã‚§ãƒƒã‚¯
```bash
# æ¯æœã®é‹ç”¨ãƒã‚§ãƒƒã‚¯
python3 simple_monitor.py && echo "âœ… ã‚·ã‚¹ãƒ†ãƒ æ­£å¸¸"
```

### 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª
```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
find backups/ -name "*.py" -mtime -1
```

### 3. ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª
```bash
# ç•°å¸¸ãŒãªã„ã‹ç¢ºèª
grep -l "warning\|error" reports/coverage_monitor_*.json | tail -5
```

## ğŸ”® å°†æ¥ã®æ‹¡å¼µäºˆå®š

- [ ] Slack/Discordé€šçŸ¥é€£æº
- [ ] Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥
- [ ] å›½éš›å¸‚å ´å¯¾å¿œ (æ¬§å·ã€ã‚¢ã‚¸ã‚¢)
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ 

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆï¼š

1. `simple_monitor.py`ã§ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª
2. `logs/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
4. å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºè€…ã«é€£çµ¡

---

**æœ€çµ‚æ›´æ–°**: 2025-08-18  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0  
**å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ **: Linux, macOS, Windows (WSL2)