# æœªæ¥ä¾¡æ ¼ é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«
# Miraikakaku Platform Operations Manual

## ğŸ¯ æ¦‚è¦

ã“ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã¯ã€æœªæ¥ä¾¡æ ¼ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®æ—¥å¸¸é‹ç”¨ã€ç›£è¦–ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã«é–¢ã™ã‚‹åŒ…æ‹¬çš„ãªæ‰‹é †æ›¸ã§ã™ã€‚

---

## ğŸ“‹ æ—¥å¸¸é‹ç”¨ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ¯æ—¥ã®é‹ç”¨ã‚¿ã‚¹ã‚¯

#### æœã®ã‚·ã‚¹ãƒ†ãƒ ãƒã‚§ãƒƒã‚¯ (9:00 AM)
- [ ] ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
- [ ] å¤œé–“ãƒãƒƒãƒå‡¦ç†ã®çµæœç¢ºèª
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆãƒ»ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª
- [ ] ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ç¢ºèª
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—çŠ¶æ³ã®ç¢ºèª

#### æ—¥ä¸­ã®ç›£è¦– (æ¯2æ™‚é–“)
- [ ] ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèª
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼æ´»å‹•çŠ¶æ³ã®ç›£è¦–
- [ ] APIå‘¼ã³å‡ºã—çŠ¶æ³ã®ç¢ºèª
- [ ] äºˆæ¸¬ç²¾åº¦ã®ç¢ºèª

#### å¤•æ–¹ã®ç·åˆãƒã‚§ãƒƒã‚¯ (6:00 PM)
- [ ] ä¸€æ—¥ã®çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆç¢ºèª
- [ ] ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³
- [ ] ç¿Œæ—¥ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨ˆç”»ç¢ºèª

### é€±æ¬¡é‹ç”¨ã‚¿ã‚¹ã‚¯

#### æ¯é€±æœˆæ›œæ—¥
- [ ] é€±æ¬¡ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ã‚¹ã‚­ãƒ£ãƒ³å®Ÿè¡Œ
- [ ] ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–å®Ÿè¡Œ

#### æ¯é€±é‡‘æ›œæ—¥
- [ ] é€±æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®æ¤œè¨¼
- [ ] ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã®ç¢ºèªãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- [ ] ãƒ­ã‚° ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª
- [ ] ç¿Œé€±ã®ãƒ‡ãƒ—ãƒ­ã‚¤è¨ˆç”»ç¢ºèª

### æœˆæ¬¡é‹ç”¨ã‚¿ã‚¹ã‚¯

#### æ¯æœˆ1æ—¥
- [ ] æœˆæ¬¡ã‚·ã‚¹ãƒ†ãƒ  ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
- [ ] SLA é”æˆçŠ¶æ³ã®è©•ä¾¡
- [ ] å®¹é‡è¨ˆç”»ã®è¦‹ç›´ã—
- [ ] ç½å®³å¾©æ—§è¨ˆç”»ã®è¦‹ç›´ã—

---

## ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•ãƒ»åœæ­¢æ‰‹é †

### å…¨ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•æ‰‹é †

#### 1. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£èµ·å‹•
```bash
# Docker Composeç’°å¢ƒã®å ´åˆ
docker-compose up -d postgresql redis

# Kubernetesç’°å¢ƒã®å ´åˆ
kubectl apply -f k8s/postgresql.yaml
kubectl apply -f k8s/redis.yaml

# èµ·å‹•ç¢ºèª (30ç§’å¾…æ©Ÿ)
sleep 30
```

#### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
```bash
# çµ±åˆã‚·ã‚¹ãƒ†ãƒ  ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼èµ·å‹•
python3 integrated_system_orchestrator.py &

# ã¾ãŸã¯å€‹åˆ¥èµ·å‹•
cd miraikakakuapi
python3 simple_api_server.py &

# MLã‚·ã‚¹ãƒ†ãƒ èµ·å‹•
python3 advanced_ml_engine.py &
python3 realtime_streaming_engine.py &
```

#### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•
```bash
cd miraikakakufront
npm run build  # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç”¨
npm start &     # ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
```

#### 4. ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•
```bash
python3 monitoring_alert_system.py &
```

#### 5. èµ·å‹•ç¢ºèª
```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
curl http://localhost:8080/health
curl http://localhost:3000/api/health

# ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª
python3 -c "
from integrated_system_orchestrator import IntegratedSystemOrchestrator
orchestrator = IntegratedSystemOrchestrator()
status = orchestrator.get_system_dashboard()
print('System Health:', status['overview']['system_health'])
"
```

### å…¨ã‚·ã‚¹ãƒ†ãƒ åœæ­¢æ‰‹é †

#### 1. ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åœæ­¢
```bash
# ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‹ã‚‰ã®é™¤å¤–
# nginxè¨­å®šå¤‰æ›´ã¾ãŸã¯Kubernetesã‚µãƒ¼ãƒ“ã‚¹åœæ­¢
kubectl scale deployment miraikakaku-api --replicas=0
kubectl scale deployment miraikakaku-frontend --replicas=0
```

#### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åœæ­¢
```bash
# çµ±åˆã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼çµŒç”±
python3 -c "
from integrated_system_orchestrator import IntegratedSystemOrchestrator
orchestrator = IntegratedSystemOrchestrator()
orchestrator.stop_system()
"

# ã¾ãŸã¯å€‹åˆ¥åœæ­¢
pkill -f "simple_api_server.py"
pkill -f "advanced_ml_engine.py"
pkill -f "realtime_streaming_engine.py"
pkill -f "npm start"
```

#### 3. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£åœæ­¢
```bash
# Docker Compose
docker-compose down

# Kubernetes
kubectl delete -f k8s/
```

---

## ğŸ“Š ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆå¯¾å¿œ

### ã‚¢ãƒ©ãƒ¼ãƒˆ ãƒ¬ãƒ™ãƒ«ã¨å¯¾å¿œ

#### ğŸŸ¢ INFO ãƒ¬ãƒ™ãƒ«
**å¯¾å¿œ**: æƒ…å ±ã¨ã—ã¦è¨˜éŒ²ã€å³åº§ã®å¯¾å¿œä¸è¦
- ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•/åœæ­¢
- å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹é–‹å§‹/å®Œäº†
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†

#### ğŸŸ¡ WARNING ãƒ¬ãƒ™ãƒ«
**å¯¾å¿œ**: 30åˆ†ä»¥å†…ã«ç¢ºèªãƒ»å¯¾å¿œ
- CPUä½¿ç”¨ç‡ > 80%
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ > 85%
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ > 500ms
- äºˆæ¸¬ç²¾åº¦ä½ä¸‹

**å¯¾å¿œæ‰‹é †**:
1. ã‚¢ãƒ©ãƒ¼ãƒˆè©³ç´°ç¢ºèª
2. ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç¢ºèª: `htop`, `free -h`
3. è² è·åˆ†æ•£ã¾ãŸã¯ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—æ¤œè¨
4. å•é¡Œè§£æ±ºå¾Œã€ã‚¢ãƒ©ãƒ¼ãƒˆè§£é™¤

#### ğŸ”´ ERROR ãƒ¬ãƒ™ãƒ«
**å¯¾å¿œ**: 15åˆ†ä»¥å†…ã«ç¢ºèªãƒ»å¯¾å¿œé–‹å§‹
- ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼
- é«˜ã‚¨ãƒ©ãƒ¼ç‡ (> 5%)
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç•°å¸¸æ¤œçŸ¥

**å¯¾å¿œæ‰‹é †**:
1. å³åº§ã«ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“è€…ã«é€šçŸ¥
2. å½±éŸ¿ç¯„å›²ã®ç‰¹å®š
3. ç·Šæ€¥å¯¾å¿œå®Ÿæ–½
4. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå ±å‘Šæ›¸ä½œæˆ

#### âš« CRITICAL ãƒ¬ãƒ™ãƒ«
**å¯¾å¿œ**: å³åº§ã«å¯¾å¿œé–‹å§‹
- ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“åœæ­¢
- ãƒ‡ãƒ¼ã‚¿æå¤±ãƒªã‚¹ã‚¯
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¾µå®³
- SLAå¤§å¹…é•å

**å¯¾å¿œæ‰‹é †**:
1. ç·Šæ€¥å¯¾ç­–æœ¬éƒ¨è¨­ç½®
2. å…¨ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã«ç·Šæ€¥é€£çµ¡
3. ç½å®³å¾©æ—§è¨ˆç”»å®Ÿè¡Œ
4. çµŒå–¶é™£ãƒ»é¡§å®¢ã¸ã®å ±å‘Š

### ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

#### ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–é …ç›®
```bash
# CPUä½¿ç”¨ç‡ç¢ºèª
top -bn1 | grep "Cpu(s)"

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ç¢ºèª
free -h

# ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ç¢ºèª
df -h

# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª
netstat -i
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–
```bash
# APIå¿œç­”æ™‚é–“ç¢ºèª
curl -w "@curl-format.txt" -s -o /dev/null http://localhost:8080/api/health

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
python3 -c "
import psycopg2
try:
    conn = psycopg2.connect('postgresql://user:pass@localhost/miraikakaku')
    print('Database connection: OK')
except Exception as e:
    print('Database connection: ERROR -', e)
"

# äºˆæ¸¬ç²¾åº¦ç¢ºèª
python3 -c "
from advanced_analytics_system import AdvancedAnalyticsSystem
analytics = AdvancedAnalyticsSystem()
report = analytics.get_system_dashboard()
print('Prediction Accuracy:', report.get('metrics', {}).get('accuracy', 'N/A'))
"
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ä¸€èˆ¬çš„ãªå•é¡Œã¨è§£æ±ºç­–

#### å•é¡Œ: ã‚·ã‚¹ãƒ†ãƒ ãŒå¿œç­”ã—ãªã„
**ç—‡çŠ¶**:
- Webã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„
- APIãŒå¿œç­”ã—ãªã„

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
ps aux | grep -E "(simple_api_server|npm)"

# 2. ãƒãƒ¼ãƒˆç¢ºèª
netstat -tlnp | grep -E "(3000|8080)"

# 3. ãƒ­ã‚°ç¢ºèª
tail -f /var/log/miraikakaku/api.log
tail -f /var/log/miraikakaku/frontend.log

# 4. ãƒªã‚½ãƒ¼ã‚¹ç¢ºèª
htop
df -h
```

**è§£æ±ºç­–**:
```bash
# ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
systemctl restart miraikakaku-api
systemctl restart miraikakaku-frontend

# Dockerç’°å¢ƒã®å ´åˆ
docker-compose restart api
docker-compose restart frontend
```

#### å•é¡Œ: äºˆæ¸¬ç²¾åº¦ãŒæ€¥æ¿€ã«ä½ä¸‹
**ç—‡çŠ¶**:
- äºˆæ¸¬ç²¾åº¦ãŒé€šå¸¸ã®80%ã‹ã‚‰60%ã«ä½ä¸‹
- äºˆæ¸¬çµæœãŒæ˜ã‚‰ã‹ã«ç•°å¸¸

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ç¢ºèª
python3 -c "
from advanced_ml_engine import AdvancedMLEngine
engine = AdvancedMLEngine()
health = engine.get_system_health()
print('ML System Status:', health)
"

# 2. ãƒ‡ãƒ¼ã‚¿å“è³ªç¢ºèª
python3 -c "
import pandas as pd
# æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿å“è³ªã‚’ãƒã‚§ãƒƒã‚¯
print('Data quality check completed')
"
```

**è§£æ±ºç­–**:
```bash
# 1. ãƒ¢ãƒ‡ãƒ«å†å­¦ç¿’å®Ÿè¡Œ
python3 -c "
from advanced_ml_engine import AdvancedMLEngine
engine = AdvancedMLEngine()
engine.retrain_models()
"

# 2. ãƒ‡ãƒ¼ã‚¿å“è³ªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¼·åŒ–
# 3. ç•°å¸¸å€¤æ¤œå‡ºãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´
```

#### å•é¡Œ: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**:
- "connection refused" ã‚¨ãƒ©ãƒ¼
- é…ã„ã‚¯ã‚¨ãƒªå®Ÿè¡Œ

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. PostgreSQLçŠ¶æ…‹ç¢ºèª
systemctl status postgresql
pg_isready -h localhost

# 2. æ¥ç¶šæ•°ç¢ºèª
sudo -u postgres psql -c "SELECT count(*) FROM pg_stat_activity;"

# 3. ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªç¢ºèª
sudo -u postgres psql -d miraikakaku -c "
SELECT query, mean_time, calls FROM pg_stat_statements
ORDER BY mean_time DESC LIMIT 5;"
```

**è§£æ±ºç­–**:
```bash
# 1. PostgreSQLå†èµ·å‹•
sudo systemctl restart postgresql

# 2. æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®šèª¿æ•´
# config/database.yml ã§max_connectionsèª¿æ•´

# 3. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–
sudo -u postgres psql -d miraikakaku -c "REINDEX DATABASE miraikakaku;"
```

### ç·Šæ€¥æ™‚å¯¾å¿œæ‰‹é †

#### ã‚·ã‚¹ãƒ†ãƒ å…¨åœæ­¢æ™‚ã®å¯¾å¿œ

**æ®µéš1: å³åº§ã®å¯¾å¿œ (0-5åˆ†)**
```bash
# 1. å½±éŸ¿ç¯„å›²ç¢ºèª
curl -I http://miraikakaku.com
curl -I http://api.miraikakaku.com

# 2. ç·Šæ€¥ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒšãƒ¼ã‚¸è¡¨ç¤º
# nginxè¨­å®šã§ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

# 3. ãƒãƒ¼ãƒ é€šçŸ¥
# Slackç·Šæ€¥ãƒãƒ£ãƒ³ãƒãƒ«ã§çŠ¶æ³å…±æœ‰
```

**æ®µéš2: åŸå› èª¿æŸ» (5-15åˆ†)**
```bash
# 1. ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ç¢ºèª
journalctl -f -u miraikakaku-*

# 2. ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ³ç¢ºèª
htop
df -h
iostat -x 1

# 3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª
ping google.com
nslookup miraikakaku.com
```

**æ®µéš3: å¾©æ—§ä½œæ¥­ (15-30åˆ†)**
```bash
# 1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©æ—§
./scripts/restore_from_backup.sh latest

# 2. ã‚·ã‚¹ãƒ†ãƒ å†èµ·å‹•
./scripts/full_system_restart.sh

# 3. å‹•ä½œç¢ºèª
./scripts/health_check.sh
```

**æ®µéš4: äº‹å¾Œå¯¾å¿œ (30åˆ†-24æ™‚é–“)**
- ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå ±å‘Šæ›¸ä½œæˆ
- æ ¹æœ¬åŸå› åˆ†æ
- å†ç™ºé˜²æ­¢ç­–ã®ç­–å®š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘å ±å‘Š

---

## ğŸ”„ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ‰‹é †

### å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

#### é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ (æ¯é€±æ—¥æ›œ 2:00 AM)

**äº‹å‰æº–å‚™**:
```bash
# 1. ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹é€šçŸ¥
echo "Maintenance scheduled for $(date)" | \
  curl -X POST -H 'Content-type: application/json' \
  --data '{"text":"Weekly maintenance starting"}' \
  $SLACK_WEBHOOK_URL

# 2. ç¾åœ¨ã®çŠ¶æ…‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
./scripts/create_maintenance_backup.sh
```

**ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å®Ÿè¡Œ**:
```bash
# 1. ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åœæ­¢
./scripts/stop_traffic.sh

# 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–
sudo -u postgres psql -d miraikakaku -c "
VACUUM ANALYZE;
REINDEX DATABASE miraikakaku;
"

# 3. ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
logrotate /etc/logrotate.d/miraikakaku

# 4. ã‚·ã‚¹ãƒ†ãƒ æ›´æ–°
./scripts/system_update.sh

# 5. ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
./scripts/full_system_restart.sh

# 6. å‹•ä½œç¢ºèª
./scripts/post_maintenance_check.sh
```

**äº‹å¾Œç¢ºèª**:
```bash
# 1. å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python3 load_testing_quality_assurance.py

# 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèª
./scripts/performance_check.sh

# 3. ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å®Œäº†é€šçŸ¥
echo "Maintenance completed successfully" | \
  curl -X POST -H 'Content-type: application/json' \
  --data '{"text":"Weekly maintenance completed"}' \
  $SLACK_WEBHOOK_URL
```

#### æœˆæ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ (ç¬¬1æ—¥æ›œ 2:00 AM)

**è¿½åŠ ä½œæ¥­**:
```bash
# 1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ›´æ–°
./scripts/security_update.sh

# 2. ä¾å­˜é–¢ä¿‚æ›´æ–°
pip-review --local --auto
npm audit fix

# 3. SSLè¨¼æ˜æ›¸ç¢ºèª
certbot certificates

# 4. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ¤œè¨¼
./scripts/verify_all_backups.sh

# 5. ç½å®³å¾©æ—§ãƒ†ã‚¹ãƒˆ
./scripts/dr_test.sh
```

### ç·Šæ€¥ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç·Šæ€¥ãƒ‘ãƒƒãƒé©ç”¨
```bash
# 1. ç·Šæ€¥ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å®£è¨€
./scripts/emergency_maintenance_start.sh

# 2. ãƒ‘ãƒƒãƒé©ç”¨
./scripts/apply_security_patch.sh $PATCH_VERSION

# 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
./scripts/security_test.sh

# 4. æ®µéšçš„å¾©æ—§
./scripts/gradual_restore.sh
```

---

## ğŸ“Š ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©æ—§

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

#### è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
# æ¯æ™‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— (cronè¨­å®š)
0 * * * * /opt/miraikakaku/scripts/hourly_backup.sh

# æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
0 3 * * * /opt/miraikakaku/scripts/daily_backup.sh

# é€±æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
0 4 * * 0 /opt/miraikakaku/scripts/weekly_backup.sh
```

#### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹
```bash
#!/bin/bash
# daily_backup.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/miraikakaku/$DATE"

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
pg_dump -h localhost -U postgres miraikakaku > \
  $BACKUP_DIR/database_$DATE.sql

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar -czf $BACKUP_DIR/config_$DATE.tar.gz \
  /opt/miraikakaku/config/

# ãƒ­ã‚°ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar -czf $BACKUP_DIR/logs_$DATE.tar.gz \
  /var/log/miraikakaku/

# AWS S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
aws s3 sync $BACKUP_DIR s3://miraikakaku-backup/$DATE/

echo "Backup completed: $BACKUP_DIR"
```

### å¾©æ—§æ‰‹é †

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¾©æ—§
```bash
# 1. ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åœæ­¢
systemctl stop postgresql

# 2. ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé€€é¿
mv /var/lib/postgresql/14/main /var/lib/postgresql/14/main.backup

# 3. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©æ—§
createdb miraikakaku
psql -d miraikakaku < /backup/database_latest.sql

# 4. PostgreSQLå†èµ·å‹•
systemctl start postgresql

# 5. æ•´åˆæ€§ç¢ºèª
psql -d miraikakaku -c "SELECT count(*) FROM stock_prices;"
```

#### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å¾©æ—§
```bash
#!/bin/bash
# full_system_restore.sh

BACKUP_DATE=$1  # ä¾‹: 20241201_030000

# 1. ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢
./scripts/stop_all_services.sh

# 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¾©æ—§
./scripts/restore_database.sh $BACKUP_DATE

# 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¾©æ—§
tar -xzf /backup/$BACKUP_DATE/config_$BACKUP_DATE.tar.gz -C /

# 4. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¾©æ—§
./scripts/deploy_from_backup.sh $BACKUP_DATE

# 5. ã‚·ã‚¹ãƒ†ãƒ å†èµ·å‹•
./scripts/start_all_services.sh

# 6. å‹•ä½œç¢ºèª
./scripts/verify_restore.sh
```

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

### ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–
```sql
-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
CREATE INDEX CONCURRENTLY idx_stock_prices_symbol_date
ON stock_prices (symbol, date DESC);

-- ãƒ†ãƒ¼ãƒ–ãƒ«çµ±è¨ˆæ›´æ–°
ANALYZE stock_prices;

-- ä¸è¦ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
DELETE FROM stock_prices
WHERE date < NOW() - INTERVAL '2 years';

-- ãƒã‚­ãƒ¥ãƒ¼ãƒ å®Ÿè¡Œ
VACUUM ANALYZE stock_prices;
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ€é©åŒ–
```python
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®šèª¿æ•´
CACHE_CONFIG = {
    'prediction_cache_ttl': 300,  # 5åˆ†
    'market_data_cache_ttl': 60,  # 1åˆ†
    'user_session_ttl': 3600,     # 1æ™‚é–“
}

# æ¥ç¶šãƒ—ãƒ¼ãƒ«èª¿æ•´
DATABASE_POOL_CONFIG = {
    'min_connections': 10,
    'max_connections': 50,
    'pool_timeout': 30,
}
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

#### é‡è¦æŒ‡æ¨™ã®ç›£è¦–
```bash
# APIå¿œç­”æ™‚é–“ç›£è¦–
curl -w "@curl-format.txt" -s -o /dev/null \
  http://localhost:8080/api/predictions/AAPL

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ€§èƒ½ç›£è¦–
psql -d miraikakaku -c "
SELECT
  schemaname,
  tablename,
  n_tup_ins,
  n_tup_upd,
  n_tup_del,
  n_live_tup,
  n_dead_tup
FROM pg_stat_user_tables
ORDER BY n_live_tup DESC;
"

# ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–
iostat -x 1 5
vmstat 1 5
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‹ç”¨

### æ—¥å¸¸ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ãƒã‚§ãƒƒã‚¯

#### ã‚¢ã‚¯ã‚»ã‚¹ ãƒ­ã‚°ç›£è¦–
```bash
# ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
tail -f /var/log/nginx/access.log | \
  grep -E "(404|500|403)" | \
  awk '{print $1}' | sort | uniq -c | sort -nr

# å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¤œå‡º
awk '{print $1}' /var/log/nginx/access.log | \
  sort | uniq -c | sort -nr | head -20

# å¤±æ•—ã—ãŸèªè¨¼è©¦è¡Œæ¤œå‡º
grep "authentication failed" /var/log/miraikakaku/api.log
```

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ã‚¹ã‚­ãƒ£ãƒ³å®Ÿè¡Œ
```bash
# è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
python3 -c "
from enterprise_features_system import EnterpriseFeaturesSystem
enterprise = EnterpriseFeaturesSystem()
security_scan = enterprise.security_scanner.scan_vulnerabilities('http://localhost:8080')
print('Security scan completed:', len(security_scan), 'issues found')
"

# ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
pip-audit
npm audit
```

#### SSL/TLS è¨¼æ˜æ›¸ç®¡ç†
```bash
# è¨¼æ˜æ›¸æœ‰åŠ¹æœŸé™ç¢ºèª
openssl x509 -in /etc/ssl/certs/miraikakaku.com.crt -noout -dates

# Let's Encrypt è¨¼æ˜æ›¸æ›´æ–°
certbot renew --dry-run

# SSLè¨­å®šãƒ†ã‚¹ãƒˆ
openssl s_client -connect miraikakaku.com:443 -servername miraikakaku.com
```

---

## ğŸ“ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»é€£çµ¡å…ˆ

### å¯¾å¿œãƒ¬ãƒ™ãƒ«åˆ¥é€£çµ¡å…ˆ

#### Level 1: ä¸€èˆ¬çš„ãªå•é¡Œ
- **å¯¾å¿œè€…**: ã‚ªãƒ³ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£ ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- **é€£çµ¡å…ˆ**: +81-XX-XXXX-XXXX
- **Slack**: #ops-level1
- **å¯¾å¿œæ™‚é–“**: 24æ™‚é–“ä»¥å†…

#### Level 2: é‡è¦ãªå•é¡Œ
- **å¯¾å¿œè€…**: ã‚·ãƒ‹ã‚¢ ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- **é€£çµ¡å…ˆ**: +81-XX-XXXX-XXXY
- **Slack**: #ops-level2
- **å¯¾å¿œæ™‚é–“**: 2æ™‚é–“ä»¥å†…

#### Level 3: ç·Šæ€¥äº‹æ…‹
- **å¯¾å¿œè€…**: ãƒ†ãƒƒã‚¯ ãƒªãƒ¼ãƒ‰ / CTO
- **é€£çµ¡å…ˆ**: +81-XX-XXXX-XXXZ
- **Slack**: #emergency
- **å¯¾å¿œæ™‚é–“**: 30åˆ†ä»¥å†…

### ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ãƒ­ãƒ¼

```
å•é¡Œç™ºç”Ÿ â†’ Level 1å¯¾å¿œ (30åˆ†)
    â†“ è§£æ±ºã—ãªã„
Level 2ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (1æ™‚é–“)
    â†“ è§£æ±ºã—ãªã„
Level 3ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (2æ™‚é–“)
    â†“ è§£æ±ºã—ãªã„
ç·Šæ€¥å¯¾ç­–æœ¬éƒ¨è¨­ç½®
```

---

## ğŸ“š å‚è€ƒè³‡æ–™ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### å†…éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **ã‚·ã‚¹ãƒ†ãƒ  ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: `/docs/architecture.md`
- **API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**: `/docs/api-reference.md`
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ã‚¹ã‚­ãƒ¼ãƒ**: `/docs/database-schema.md`
- **ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ ã‚¬ã‚¤ãƒ‰**: `/docs/deployment-guide.md`

### å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹
- **PostgreSQL ãƒãƒ‹ãƒ¥ã‚¢ãƒ«**: https://www.postgresql.org/docs/
- **Next.js ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://nextjs.org/docs
- **FastAPI ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://fastapi.tiangolo.com/
- **Docker ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://docs.docker.com/

### ç·Šæ€¥æ™‚å‚è€ƒè³‡æ–™
- **ç½å®³å¾©æ—§è¨ˆç”»**: `/docs/disaster-recovery-plan.md`
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ**: `/docs/security-incident-response.md`
- **ãƒ‡ãƒ¼ã‚¿æ¼æ´©å¯¾å¿œ**: `/docs/data-breach-response.md`

---

## ğŸ“ å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | æ‹…å½“è€… |
|------|-----------|----------|---------|
| 2024-12-01 | 1.0.0 | åˆç‰ˆä½œæˆ | DevOps Team |
| 2024-12-15 | 1.1.0 | ç›£è¦–æ‰‹é †è¿½åŠ  | DevOps Team |
| 2024-12-20 | 1.2.0 | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ‰‹é †å¼·åŒ– | Security Team |

---

*æœ€çµ‚æ›´æ–°: 2024å¹´12æœˆ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.2.0*

**ğŸ”§ æœªæ¥ä¾¡æ ¼ é‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ« - å®‰å®šç¨¼åƒã®ãŸã‚ã®åŒ…æ‹¬ã‚¬ã‚¤ãƒ‰ ğŸ”§**